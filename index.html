<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Bird Watch Arcade ü¶©</title>

  <!-- PostHog -->
  <script>
    !function(t,e){var o,n,p,r;e.__SV||(window.posthog&&window.posthog.__loaded)||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init capture register register_once unregister getFeatureFlag isFeatureEnabled reloadFeatureFlags onFeatureFlags identify reset get_distinct_id get_session_id startSessionRecording stopSessionRecording".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);

    posthog.init("phc_DQJyMgMb9vXZWTjaEnrZ5ANFvxuw0u9VOsqBTZy8XDM", {
      api_host: "https://us.i.posthog.com",
      person_profiles: "identified_only",
      autocapture: false,
      capture_pageview: true
    });
  </script>

  <style>
    :root{
      --bg1:#fff6fb; --bg2:#eef7ff; --card:rgba(255,255,255,.75);
      --stroke:rgba(30,41,59,.12); --text:#0f172a; --muted:rgba(15,23,42,.65);
      --shadow:0 18px 55px rgba(15,23,42,.12); --radius:20px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh;
      font-family:system-ui,-apple-system,Segoe UI,Roboto;
      background:
        radial-gradient(1200px 700px at 15% 10%,var(--bg1),transparent 60%),
        radial-gradient(900px 600px at 80% 20%,var(--bg2),transparent 60%),
        linear-gradient(180deg,#fff,#f7f7ff);
      display:grid; place-items:center; padding:16px;
      color:var(--text);
    }
    .wrap{width:min(560px,100%)}
    h1{margin:0;font-size:22px}
    .rules{font-size:13.5px;color:var(--muted);margin-top:6px}

    .hud{
      display:grid; grid-template-columns:repeat(3,1fr);
      gap:10px; margin:14px 0;
    }
    .pill{
      background:var(--card); border:1px solid var(--stroke);
      border-radius:999px; padding:10px;
      display:flex; gap:6px; justify-content:center;
      font-weight:700;
    }

    .panel{
      background:var(--card); border:1px solid var(--stroke);
      border-radius:var(--radius); padding:14px;
      box-shadow:var(--shadow); backdrop-filter:blur(10px);
    }

    .topbar{display:flex;justify-content:space-between;align-items:center}
    .btn{
      border:1px solid rgba(99,102,241,.25);
      background:linear-gradient(180deg,#fff,#f3f4ff);
      padding:10px 12px;border-radius:12px;
      font-weight:800; cursor:pointer;
    }
    .btn[disabled]{opacity:.5; cursor:not-allowed}
    .status{font-size:13px;color:var(--muted)}

    .grid{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:12px; margin-top:12px;
    }

    .tile{
      height:84px; border-radius:16px;
      background:rgba(255,255,255,.7);
      border:1px solid var(--stroke);
      display:grid; place-items:center;
      position:relative; cursor:pointer;
      transition:transform .12s;
      overflow:hidden;
      user-select:none;
    }
    .tile:active{transform:scale(.97)}
    .emoji{font-size:34px}

    .tag{
      position:absolute; bottom:6px; left:8px;
      font-size:11px; font-weight:800;
      background:rgba(255,255,255,.6);
      padding:4px 8px; border-radius:999px;
    }

    .floaty{
      position:absolute; left:50%; top:50%;
      transform:translate(-50%,-50%);
      font-weight:900;
      animation:floatUp .65s ease-out forwards;
      pointer-events:none;
      text-shadow:0 8px 18px rgba(15,23,42,.18);
    }
    .floaty.negative{color:#b91c1c}

    @keyframes floatUp{
      0%{opacity:0;transform:translate(-50%,-30%) scale(.98)}
      15%{opacity:1}
      100%{opacity:0;transform:translate(-50%,-120%) scale(1.04)}
    }

    .shake{animation:shake .42s ease-in-out}
    @keyframes shake{
      0%,100%{transform:translateX(0)}
      20%{transform:translateX(-6px)}
      40%{transform:translateX(6px)}
      60%{transform:translateX(-4px)}
      80%{transform:translateX(4px)}
    }
  </style>
</head>

<body>
<div class="wrap">
  <h1>Bird Watch Arcade ü¶©</h1>
  <div class="rules">
    Tap birds to score. ü¶© is worth the most. üêç resets your score. ü™∫ doubles your last bird click.
  </div>

  <div class="hud">
    <div class="pill">Score <span id="score">0</span></div>
    <div class="pill">Time <span id="time">30</span>s</div>
    <div class="pill">Last <span id="last">‚Äî</span></div>
  </div>

  <div class="panel">
    <div class="topbar">
      <button class="btn" id="start">Start (30s)</button>
      <div class="status" id="status">Ready.</div>
    </div>
    <div class="grid" id="grid"></div>
  </div>
</div>

<script>
  const GAME_SECONDS = 30
  const POINTS = { flamingo:25, bird:10 }

  let score=0, timeLeft=GAME_SECONDS, playing=false
  let lastBasePoints=0, lastThing='‚Äî', timer=null
  let animating=false

  const $=id=>document.getElementById(id)
  const scoreEl=$('score'), timeEl=$('time'), lastEl=$('last')
  const gridEl=$('grid'), statusEl=$('status'), startBtn=$('start')

  function capturePH(e,p){
    if(window.posthog?.capture) window.posthog.capture(e,p||{})
  }

  function pop(tile,text,neg){
    const f=document.createElement('div')
    f.className='floaty'+(neg?' negative':'')
    f.textContent=text
    tile.appendChild(f)
    setTimeout(()=>f.remove(),650)
  }

  function shake(el){
    el.classList.remove('shake')
    void el.offsetWidth
    el.classList.add('shake')
    setTimeout(()=>el.classList.remove('shake'),420)
  }

  function deal(){
    const birds=[
      {k:'bird',e:'üê¶',l:'+10'},
      {k:'bird',e:'ü¶Ü',l:'+10'},
      {k:'bird',e:'ü¶â',l:'+10'},
    ]
    const tiles=[
      {k:'flamingo',e:'ü¶©',l:'+25'},
      {k:'nest',e:'ü™∫',l:'x2'},
      {k:'snake',e:'üêç',l:'reset'},
      birds[Math.floor(Math.random()*3)],
      birds[Math.floor(Math.random()*3)],
      birds[Math.floor(Math.random()*3)],
    ]
    return tiles.sort(()=>Math.random()-.5)
  }

  let tiles=deal()

  function render(){
    gridEl.innerHTML=''
    tiles.forEach(t=>{
      const d=document.createElement('div')
      d.className='tile'
      d.innerHTML=`<div class="emoji">${t.e}</div><div class="tag">${t.l}</div>`
      d.onclick=()=>clickTile(d,t)
      gridEl.appendChild(d)
    })
  }

  function clickTile(el,t){
    if(!playing || animating) return
    animating=true

    if(t.k==='snake'){
      score=0; lastBasePoints=0; lastThing='üêç reset'
      shake(el); pop(el,'RESET',true)
      capturePH('tap_snake',{score_after:0})
    }
    else if(t.k==='nest'){
      const pts=lastBasePoints*2||0
      score+=pts; lastThing=`ü™∫ +${pts}`
      pop(el,'+'+pts)
      capturePH('tap_nest',{points:pts,score_after:score})
    }
    else{
      const base=t.k==='flamingo'?POINTS.flamingo:POINTS.bird
      score+=base; lastBasePoints=base
      lastThing=`${t.e} +${base}`
      pop(el,'+'+base)
      capturePH('tap_bird',{bird:t.k,score_after:score})
    }

    update()
    setTimeout(()=>{ tiles=deal(); render(); animating=false },250)
  }

  function update(){
    scoreEl.textContent=score
    timeEl.textContent=timeLeft
    lastEl.textContent=lastThing
  }

  function start(){
    if(playing) return
    playing=true; score=0; timeLeft=GAME_SECONDS; lastBasePoints=0; lastThing='‚Äî'
    update(); statusEl.textContent='Go!'
    startBtn.disabled=true
    capturePH('game_start',{duration_s:GAME_SECONDS})

    clearInterval(timer)
    timer=setInterval(()=>{
      timeLeft--; update()
      if(timeLeft<=0){
        clearInterval(timer); playing=false
        statusEl.textContent=`Game over. Score: ${score}`
        startBtn.disabled=false
        capturePH('game_over',{final_score:score})
      }
    },1000)
  }

  startBtn.onclick=start
  render(); update()
</script>
</body>
</html>
